# reactå…¨å®¶æ¡¶

## ä¸€ React ä»‹ç»

## äºŒ create-react-app

## ä¸‰ ç¼–å†™ä¸€ä¸ªreactåº”ç”¨ç¨‹åº

## å›› JSXè¯­æ³•ä¸ç»„ä»¶

## äº” ç»„ä»¶çš„æ•°æ®æŒ‚è½½æ–¹å¼

**çŠ¶æ€(state)**

çŠ¶æ€å°±æ˜¯ç»„ä»¶æè¿°æŸç§æ˜¾ç¤ºæƒ…å†µçš„æ•°æ®ï¼Œç”±ç»„ä»¶è‡ªå·±è®¾ç½®å’Œæ›´æ”¹ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±ç»„ä»¶è‡ªå·±ç»´æŠ¤ï¼Œä½¿ç”¨çŠ¶æ€çš„ç›®çš„å°±æ˜¯ä¸ºäº†åœ¨ä¸åŒçš„çŠ¶æ€ä¸‹ä½¿ç»„ä»¶çš„æ˜¾ç¤ºä¸åŒ(è‡ªå·±ç®¡ç†ï¼‰

### **(1)**  **å®šä¹‰**  **state**

ç¬¬ä¸€ç§æ–¹å¼

```
import React, { Component } from 'react' import ReactDOM from 'react-dom'

class App extends Component { 
    state = {
      name: 'React', isLiked: false
    }
    render () { 
        return (
        <div>
            <h1>æ¬¢è¿æ¥åˆ°{this.state.name}çš„ä¸–ç•Œ</h1>
                <button>
                {
                this.state.isLiked ? 'â¤å–æ¶ˆ' : 'ğŸ–¤æ”¶è—'
                }
                </button>
        </div>
        )
       }
    }
ReactDOM.render(
<App/>, document.getElementById('root')
)

```

å¦ä¸€ç§æ–¹å¼

```
import React, { Component } from 'react' import ReactDOM from 'react-dom'

class App extends Component { 
    constructor() {
        super() 
        this.state = {
        name: 'React', isLiked: false
        }
    }
    
        render () { 
        return (
            <div>
               <h1>æ¬¢è¿æ¥åˆ°{this.state.name}çš„ä¸–ç•Œ</h1>
                <button>
                {this.state.isLiked ? 'â¤å–æ¶ˆ' : 'ğŸ–¤æ”¶è—'}
                </button>
            </div>
        )
        }
    }
ReactDOM.render(
<App/>, document.getElementById('root')
)

```

this.state æ˜¯çº¯jså¯¹è±¡,åœ¨vueä¸­ï¼Œdataå±æ€§æ˜¯åˆ©ç”¨Object.defineProperty å¤„ç†è¿‡çš„ï¼Œæ›´æ”¹dataçš„æ•°æ®çš„æ—¶å€™ä¼šè§¦å‘æ•°æ®çš„getter å’Œsetter ï¼Œä½†æ˜¯Reactä¸­æ²¡æœ‰åšè¿™æ ·çš„å¤„ç†ï¼Œå¦‚æœç›´æ¥æ›´æ”¹çš„è¯ï¼Œ reactæ˜¯æ— æ³•å¾—çŸ¥çš„ï¼Œæ‰€ä»¥ï¼Œéœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„æ›´æ”¹çŠ¶æ€çš„æ–¹æ³• setState ã€‚

### **(2)**  **setState**

isLiked å­˜æ”¾åœ¨å®ä¾‹çš„ stateså¯¹è±¡å½“ä¸­ï¼Œç»„ä»¶çš„render å‡½æ•°å†…ï¼Œä¼šæ ¹æ®ç»„ä»¶çš„statesçš„ä¸­çš„isLiked ä¸åŒæ˜¾ç¤ºâ€œå–æ¶ˆ"æˆ–â€œæ”¶è—"å†…å®¹ã€‚ä¸‹é¢ç»™buttonåŠ ä¸Šäº†ç‚¹å‡»çš„äº‹ä»¶ç›‘å¬ã€‚

```
import React, { Component } from 'react' import ReactDOM from 'react-dom'

class App extends Component { 
    constructor() {
        super() 
        this.state = {
        name: 'React', isLiked: false
        }
    }

    handleBtnClick = () => { this.setState({
    isLiked: !this.state.isLiked
    })
  }
  
render () { 
    return (
    <div>
         <h1>æ¬¢è¿æ¥åˆ°{this.state.name}çš„ä¸–ç•Œ</h1>
        <button onClick={this.handleBtnClick}>
            {
            this.state.isLiked ? 'â¤å–æ¶ˆ' : 'ğŸ–¤æ”¶è—'
            }
        </button>
    </div>
    )
    }
}
ReactDOM.render(
<App/>, document.getElementById('root')
setState æœ‰ä¸¤ä¸ªå‚æ•°
```

ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ–¹æ³•returnä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå‚æ•°å«åš updater

å‚æ•°æ˜¯å¯¹è±¡

```
this.setState({
isLiked: !this.state.isLiked
})
```

å‚æ•°æ˜¯æ–¹æ³•

```
this.setState((prevState, props) => { return {
        isLiked: !prevState.isLiked
        }
})

```

æ³¨æ„çš„æ˜¯è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ä¸Šä¸€æ¬¡çš„state,  ç¬¬äºŒä¸ªæ˜¯props .

setState æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥æƒ³è¦è·å–åˆ°æœ€æ–°çš„stateï¼Œæ²¡æœ‰åŠæ³•è·å–ï¼Œå°±æœ‰äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å›è°ƒå‡½æ•°

```
this.setState(
(prevState, props) => { 
return {
    isLiked: !prevState.isLiked
}, 
    () => {
    console.log('å›è°ƒé‡Œçš„',this.state.isLiked)
    }
)
console.log('setStateå¤–éƒ¨çš„',this.state.isLiked)

```

### (3)å±æ€§(props)

props æ˜¯æ­£å¸¸æ˜¯å¤–éƒ¨ä¼ å…¥çš„ï¼Œç»„ä»¶å†…éƒ¨ä¹Ÿå¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼æ¥åˆå§‹åŒ–çš„è®¾ç½®ï¼Œå±æ€§ä¸èƒ½è¢«ç»„ä»¶è‡ªå·±æ›´æ”¹ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡çˆ¶ç»„ä»¶ä¸»åŠ¨é‡æ–°æ¸²æŸ“çš„æ–¹å¼æ¥ä¼ å…¥æ–°çš„å±æ€§æ˜¯æè¿°æ€§è´¨ã€ç‰¹ç‚¹çš„ï¼Œç»„ä»¶è‡ªå·±ä¸èƒ½éšæ„æ›´æ”¹ã€‚

ä¹‹å‰çš„ç»„ä»¶ä»£ç é‡Œé¢æœ‰props çš„ç®€å•ä½¿ç”¨ï¼Œæ€»çš„æ¥è¯´ï¼Œåœ¨ä½¿ç”¨ä¸€ä¸ªç»„ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠå‚æ•°æ”¾åœ¨æ ‡ç­¾çš„å±æ€§å½“ä¸­ï¼Œæ‰€æœ‰çš„å±æ€§éƒ½ä¼šä½œä¸ºç»„ä»¶å‚æ•°æ¥æ¥æ”¶props :

```
(1) åœ¨ç»„ä»¶ä¸Šé€šè¿‡key=value å†™å±æ€§,é€šè¿‡this.propsè·å–å±æ€§,è¿™æ ·ç»„ä»¶çš„å¯å¤ç”¨æ€§æé«˜äº†.
(2) æ³¨æ„åœ¨ä¼ å‚æ•°æ—¶å€™ï¼Œå¦‚æœå†™æˆisShow="true" é‚£ä¹ˆè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²,å¦‚æœå†™æˆisShow={true} è¿™ä¸ªæ˜¯å¸ƒå°”å€¼ã€‚
(3) {...å¯¹è±¡} å±•å¼€èµ‹å€¼
(4) é»˜è®¤å±æ€§å€¼

*.defaultProps = {
     é»˜è®¤éƒ½æ˜¯ç©ºï¼Œæˆ–è€…å†™å…¥
   }
  static defaultProps = { 
  myname:"é»˜è®¤çš„myname", myshow:true
}

(5) prop-types å±æ€§éªŒè¯
import propTypes from "prop-types";

*.propTypes={
     name:propTypes.string, age:propTypes.number
}

static propTypes={ 
        myname:propTypes.string,
        myshow:propTypes.bool
    }

```

### ï¼ˆ4ï¼‰å±æ€§  vs  çŠ¶æ€

ç›¸ä¼¼ç‚¹ï¼šéƒ½æ˜¯çº¯jså¯¹è±¡ï¼Œéƒ½ä¼šè§¦å‘renderæ›´æ–°ï¼Œéƒ½å…·æœ‰ç¡®å®šæ€§ï¼ˆçŠ¶æ€/å±æ€§ç›¸åŒï¼Œç»“æœç›¸åŒï¼‰

ä¸åŒç‚¹ï¼š

\1.    å±æ€§èƒ½ä»çˆ¶ç»„ä»¶è·å–ï¼ŒçŠ¶æ€ä¸èƒ½

\2.    å±æ€§å¯ä»¥ç”±çˆ¶ç»„ä»¶ä¿®æ”¹ï¼ŒçŠ¶æ€ä¸èƒ½

\3.    å±æ€§èƒ½åœ¨å†…éƒ¨è®¾ç½®é»˜è®¤å€¼ï¼ŒçŠ¶æ€ä¹Ÿå¯ä»¥ï¼Œè®¾ç½®æ–¹å¼ä¸ä¸€æ ·

\4.    å±æ€§ä¸åœ¨ç»„ä»¶å†…éƒ¨ä¿®æ”¹ï¼ŒçŠ¶æ€è¦åœ¨ç»„ä»¶å†…éƒ¨ä¿®æ”¹

\5.    å±æ€§èƒ½è®¾ç½®å­ç»„ä»¶åˆå§‹å€¼ï¼ŒçŠ¶æ€ä¸å¯ä»¥

\6.    å±æ€§å¯ä»¥ä¿®æ”¹å­ç»„ä»¶çš„å€¼ï¼ŒçŠ¶æ€ä¸å¯ä»¥



stateçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºç»„ä»¶ä¿å­˜ã€æ§åˆ¶ã€ä¿®æ”¹è‡ªå·±çš„å¯å˜çŠ¶æ€ã€‚ state åœ¨ç»„ä»¶å†…éƒ¨åˆå§‹åŒ–ï¼Œå¯ä»¥è¢«ç»„ä»¶è‡ªèº«ä¿®æ”¹ï¼Œè€Œå¤–éƒ¨ä¸èƒ½è®¿é—®ä¹Ÿä¸èƒ½ä¿®æ”¹ã€‚ä½ å¯ä»¥è®¤ä¸º state  æ˜¯ä¸€ä¸ªå±€éƒ¨çš„ã€åªèƒ½è¢«ç»„ä»¶è‡ªèº«æ§åˆ¶çš„æ•°æ®æºã€‚

stateä¸­çŠ¶æ€å¯ä»¥é€šè¿‡ this.setState æ–¹æ³•è¿›è¡Œæ›´æ–°ï¼Œ setState ä¼šå¯¼è‡´ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚

propsçš„ä¸»è¦ä½œç”¨æ˜¯è®©ä½¿ç”¨è¯¥ç»„ä»¶çš„çˆ¶ç»„ä»¶å¯ä»¥ä¼ å…¥å‚æ•°æ¥é…ç½®è¯¥ç»„ä»¶ã€‚å®ƒæ˜¯å¤–éƒ¨ä¼ è¿›æ¥çš„é…ç½®å‚æ•°ï¼Œç»„ä»¶å†…éƒ¨æ— æ³•æ§åˆ¶ä¹Ÿæ— æ³•ä¿®æ”¹ã€‚é™¤éå¤–éƒ¨ç»„ä»¶ä¸»åŠ¨ä¼ å…¥æ–°çš„ ï¼Œå¦åˆ™ç»„ä»¶çš„ä¸å˜ã€‚

æ²¡æœ‰state-çš„ç»„ä»¶å«æ— çŠ¶æ€ç»„ä»¶(stateless component)ï¼Œè®¾ç½®äº† stateçš„å«åšæœ‰çŠ¶æ€ç»„ä»¶(stateful component)ã€‚å› ä¸ºçŠ¶æ€ä¼šå¸¦æ¥ç®¡ç†çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬å°½é‡å¤šåœ°å†™æ— çŠ¶æ€ç»„ä»¶ï¼Œå°½é‡å°‘åœ°å†™æœ‰çŠ¶æ€çš„ç»„ä»¶ã€‚è¿™æ ·ä¼šé™ä½ä»£ç ç»´æŠ¤çš„éš¾åº¦ï¼Œä¹Ÿä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢å¼ºç»„ä»¶çš„å¯å¤ç”¨æ€§ã€‚

### (5)æ¸²æŸ“æ•°æ®

æ¡ä»¶æ¸²æŸ“

```
{
condition ? 'æ¸²æŸ“åˆ—è¡¨çš„ä»£ç ' : 'ç©ºç©ºå¦‚ä¹Ÿ'
}
```

åˆ—è¡¨æ¸²æŸ“

```
// æ•°æ®
const people = [
{ id: 1,name: 'Leo', age: 35}, 
{id: 2,name: 'XiaoMing', age: 16
}]
// æ¸²æŸ“åˆ—è¡¨
{
    people.map(person => { return (
        <dl key={person.id}>
        <dt>{person.name}</dt>
        <dd>age: {person.age}</dd>
        </dl>
        )
    })
}

```

Reactçš„é«˜æ•ˆä¾èµ–äºæ‰€è°“çš„Virtual-DOMï¼Œå°½é‡ä¸ç¢°DOMã€‚å¯¹äºåˆ—è¡¨å…ƒç´ æ¥è¯´ä¼šæœ‰ä¸€ä¸ªé—®é¢˜:å…ƒç´ å¯èƒ½ä¼šåœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­æ”¹å˜ä½ç½®ã€‚è¦å®ç°è¿™ä¸ªæ“ä½œï¼Œåªéœ€è¦äº¤æ¢ä¸€ä¸‹DOMä½ç½®å°±è¡Œäº†ï¼Œä½†æ˜¯Reactå¹¶ä¸çŸ¥é“å…¶å®æˆ‘ä»¬åªæ˜¯æ”¹å˜äº†å…ƒç´ çš„ä½ç½®ï¼Œæ‰€ä»¥å®ƒä¼šé‡æ–°æ¸²æŸ“åé¢ä¸¤ä¸ªå…ƒç´ (å†æ‰§è¡ŒVitual-DOM )ï¼Œè¿™æ ·ä¼šå¤§å¤§å¢åŠ DOMæ“ä½œã€‚ä½†å¦‚æœç»™æ¯ä¸ªå…ƒç´ åŠ ä¸Šå”¯ä¸€çš„æ ‡è¯†ï¼ŒReactå°±å¯ä»¥çŸ¥é“è¿™ä¸¤ä¸ªå…ƒç´ åªæ˜¯äº¤æ¢äº†ä½ç½®ï¼Œè¿™ä¸ªæ ‡è¯†å°±æ˜¯keyï¼Œè¿™ä¸ªkeyå¿…é¡»æ˜¯æ¯ä¸ªå…ƒç´ å”¯ä¸€çš„æ ‡è¯†

dangerouslySetInnerHTML

å¯¹äºå¯Œæ–‡æœ¬åˆ›å»ºçš„å†…å®¹ï¼Œåå°æ‹¿åˆ°çš„æ•°æ®æ˜¯è¿™æ ·çš„

```
content = "<p>React.jsæ˜¯ä¸€ä¸ªæ„å»ºUIçš„åº“</p>"
```

å¤„äºå®‰å…¨çš„åŸå› ï¼ŒReactå½“ä¸­æ‰€æœ‰è¡¨è¾¾å¼çš„å†…å®¹ä¼šè¢«è½¬ä¹‰ï¼Œå¦‚æœç›´æ¥è¾“å…¥ï¼Œæ ‡ç­¾ä¼šè¢«å½“æˆæ–‡æœ¬ã€‚è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨dangerouslyS.etHTMLå±æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬åŠ¨æ€è®¾ç½®innecHTML

```
import React, { Component } from 'react' import ReactDOM from 'react-dom'

class App extends Component { 
       constructor() {
        super() this.state = {
            content : "<p>React.jsæ˜¯ä¸€ä¸ªæ„å»ºUIçš„åº“</p>"
        }
    }
render () { 
   return (
        <div
        // æ³¨æ„è¿™é‡Œæ˜¯ä¸¤ä¸ªä¸‹ä¸‹åˆ’çº¿  __html 
        dangerouslySetInnerHTML={{ __html: this.state.content}}
        />
        )
     }
}

ReactDOM.render(
<App/>, document.getElementById('root')
)

```







## å…­è¡¨å•ä¸­çš„å—æ§ç§Ÿé‡‘æŒ‰å’Œéå—æ§ç»„ä»¶

## ä¸ƒ ç»„ä»¶é€šä¿¡çš„æ–¹å¼

### **1.**   çˆ¶å­ç»„ä»¶é€šä¿¡æ–¹å¼

(1)    çˆ¶ä¼ å­  çœ‹propså°èŠ‚

çˆ¶ç»„ä»¶ä¸­ï¼Œåœ¨å¼•ç”¨çš„å­ç»„ä»¶ä¸Šï¼Œkï¼švæ–¹å¼ä¼ é€’ï¼Œ

å­ç»„ä»¶ä½¿ç”¨propsæ¥æ”¶ã€‚

(2)     ä¼ é€’æ•°æ®(çˆ¶ä¼ å­)ä¸ä¼ é€’æ–¹æ³•(å­ä¼ çˆ¶)

```
ä¼ é€’æ–¹æ³•(å­ä¼ çˆ¶) 
çˆ¶ç»„ä»¶æŠŠä¿®æ”¹è‡ªå·±æ•°æ®çš„æ–¹æ³•ï¼Œé€šè¿‡å˜é‡ï¼Œä½¿ç”¨å­ç»„ä»¶ä¼ é€’è¿‡å»ã€‚å­ç»„ä»¶ä½¿ç”¨this.propsæ¥å—
import React, { Component } from 'react'

å­ç»„ä»¶
class Navbar extends Component{
    render(){
        return <div style={{background:"red"}}>
            <button onClick={()=>{
                   console.log("å­é€šçŸ¥çˆ¶ï¼Œ è®©çˆ¶çš„isSHow å–åã€‚",this.props.event) 

                   this.props.event() //è°ƒç”¨çˆ¶ç»„ä»¶ä¼ æ¥å•Šçš„å›è°ƒå‡½æ•°
            }}>click</button>
            <span>navbar</span>
        </div>
    }
}
çˆ¶ç»„ä»¶
export default class App extends Component {
    state = {
        isShow:false
    }

    handleEvent = ()=>{
        this.setState({
            isShow:!this.state.isShow
        })
        // console.log("çˆ¶ç»„ä»¶å®šä¹‰çš„eventäº‹ä»¶")
    }
    render() {
        return (
            <div>
                <Navbar event={this.handleEvent}/>
                {/* <button onClick={()=>{
                    this.setState({
                        isShow:!this.state.isShow
                    })
                }}>click</button> */}
                {this.state.isShow && <Sidebar/>}
            </div>
        )
    }
}
```

(2)     refæ ‡è®° (çˆ¶ç»„ä»¶æ‹¿åˆ°å­ç»„ä»¶çš„å¼•ç”¨ï¼Œä»è€Œè°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•)

åœ¨çˆ¶ç»„ä»¶ä¸­æ¸…é™¤å­ç»„ä»¶çš„inputè¾“å…¥æ¡†çš„valueå€¼ã€‚**this.refs.form.reset()**



### **2.**   éçˆ¶å­ç»„ä»¶é€šä¿¡æ–¹å¼

#### **(1)**   **çŠ¶æ€æå‡**  **(**ä¸­é—´äººæ¨¡å¼**)**

Reactä¸­çš„çŠ¶æ€æå‡æ¦‚æ‹¬æ¥è¯´,å°±æ˜¯å°†å¤šä¸ªç»„ä»¶éœ€è¦å…±äº«çš„çŠ¶æ€æå‡åˆ°å®ƒä»¬æœ€è¿‘çš„çˆ¶ç»„ä»¶ä¸Š.åœ¨çˆ¶ç»„ä»¶ä¸Šæ”¹å˜è¿™ä¸ªçŠ¶æ€ç„¶åé€šè¿‡propsåˆ†å‘ç»™å­ç»„ä»¶. ï¼ˆå®è´¨è¿˜æ˜¯çˆ¶å­é€šä¿¡æ–¹å¼ï¼‰

```
import React, { Component } from 'react'
import axios from 'axios'
import './css/03-communination.css'
export default class App extends Component {

    constructor(){
        super()
        this.state = {
            filmList:[],
            info:""
        }
    }
    æ•°æ®æ¥è‡ªäº’è”ç½‘
    https://m.maizuo.com/v5/#/films/nowPlaying
    componentDidMount(){
        axios.get(`/test.json`).then(res=>{
            console.log(res.data.data.films)
            this.setState({
                filmList:res.data.data.films
            })
        })
    }

    render() {
        return (
            <div>
                {/* {this.state.info} */}
                {
                    this.state.filmList.map(item=>
                        <FilmItem key={item.filmId} {...item} onEvent={(value)=>{
                            // console.log("çˆ¶ç»„ä»¶æ¥å—",value)

                            this.setState({
                                info:value
                            })
                        }}></FilmItem>    
                    )
                }


                <FilmDetail info={this.state.info}></FilmDetail>
            </div>
        )
    }
}

/*å—æ§ç»„ä»¶*/
class FilmItem extends Component{
    render(){
        // console.log(this.props)
        let {name, poster,grade,synopsis}  = this.props
        return <div className="filmitem" onClick={()=>{
            // console.log(synopsis)
            this.props.onEvent(synopsis)
        }}>
            <img src={poster} alt={name}/>
            <h4>{name}</h4>
            <div>è§‚ä¼—è¯„åˆ†ï¼š{grade}</div>
        </div>
    }
}

class FilmDetail extends Component{
   
    render(){
        console.log(this.props)
        return <div className="filmdetail">
            {this.props.info}
        </div>
    }
}
```



#### **(2)**   å‘å¸ƒè®¢é˜…æ¨¡å¼å®ç°

çº¯jså®ç° ï¼Œè°è®¢é˜…ï¼Œè°æ¥å—ï¼ŒæŠ›å¼ƒäº†çˆ¶å­å­™å…³ç³»ã€‚

```
/*
 * @ä½œè€…: kerwin
 * @å…¬ä¼—å·: å¤§å‰ç«¯ç§æˆ¿èœ
 */
import React, { Component } from 'react'

export default class App extends Component {
    render() {
        return (
            <div>
                app
            </div>
        )
    }
}

//è°ƒåº¦ä¸­å¿ƒ
var bus = {

    list:[],
    //è®¢é˜…
    subscribe(callback){
        // console.log(callback)

        this.list.push(callback)
    },

    //å‘å¸ƒ
    publish(text){
        //éå†æ‰€æœ‰çš„listï¼Œ å°†å›è°ƒå‡½æ•°æ‰§è¡Œ
        // console.log(this.list)

        this.list.forEach(callback=>{
            callback && callback(text)
        })
    }
}


// è®¢é˜…è€…
bus.subscribe((value)=>{
    console.log("11111",value)
})

bus.subscribe((value)=>{
    console.log("2222",value)
})



//å‘å¸ƒè€…

setTimeout(()=>{
    bus.publish("ç”·äººçœ‹äº†æ²‰é»˜111")
},0)


// Redux åŸºäºè®¢é˜…å‘å¸ƒ 

```



#### **(3)**   **context** çŠ¶æ€æ ‘ä¼ å‚

```
import React, { Component } from 'react'
import axios from 'axios'
import './css/03-communination.css'

const GlobalContext  = React.createContext() //åˆ›å»ºcontextå¯¹è±¡

export default class App extends Component {

    constructor(){
        super()
        this.state = {
            filmList:[],
            info:""
        }
        axios.get(`/test.json`).then(res=>{
            console.log(res.data.data.films)
            this.setState({
                filmList:res.data.data.films
            })
        })
    }

    render() {
        return (
            <GlobalContext.Provider value={{
                call:"æ‰“ç”µè¯",
                sms:"çŸ­ä¿¡",
                info:this.state.info,
                changeInfo:(value)=>{
                    this.setState( {
                        info:value
                    })
                }
            }}>
                <div>
                    {/* {this.state.info} */}
                    {
                        this.state.filmList.map(item=>
                            <FilmItem key={item.filmId} {...item} ></FilmItem>    
                        )
                    }


                    <FilmDetail ></FilmDetail>
                </div>
            </GlobalContext.Provider>
        )
    }
}

/*å—æ§ç»„ä»¶*/
class FilmItem extends Component{
    render(){
        // console.log(this.props)
        let {name, poster,grade,synopsis}  = this.props
        return (
        <GlobalContext.Consumer>
           {
                (value)=>{
                    console.log(value)
                    
                    return <div className="filmitem" onClick={()=>{
                        console.log(synopsis)
                        // this.props.onEvent(synopsis)

                        // value.info = "2222222"

                        // console.log(value)

                        value.changeInfo(synopsis)
                    }}>
                        <img src={poster} alt={name}/>
                        <h4>{name}</h4>
                        <div>è§‚ä¼—è¯„åˆ†ï¼š{grade}</div>
                    </div>
                }
           }
        </GlobalContext.Consumer>
        )    
    }
}

class FilmDetail extends Component{
    render(){
        return (
            <GlobalContext.Consumer>
                {
                    (value)=><div className="filmdetail">
                        detail-{value.info}
                    </div>
                }
            </GlobalContext.Consumer>
        )
    }
}
```







## å…« Reactç”Ÿå‘½å‘¨æœŸ





## ä¹ React Hooks

### 1 ç”¨hooksç†ç”±

1. é«˜é˜¶ç»„ä»¶ä¸ºäº†å¤ç”¨ï¼Œå¯¼è‡´ä»£ç å±‚çº§å¤æ‚

2. ç”Ÿå‘½å‘¨æœŸçš„å¤æ‚
3. å†™æˆfunctionalç»„ä»¶,æ— çŠ¶æ€ç»„ä»¶ ï¼Œå› ä¸ºéœ€è¦çŠ¶æ€ï¼Œåˆæ”¹æˆäº†class,æˆæœ¬é«˜

### 2. useState(ä¿å­˜ç»„ä»¶çŠ¶æ€)

```
const [list,setList] = useState(["aa","bb","cc"])
ç»“æ„å‡ºlistå˜é‡ï¼Œ å’Œä¿®æ”¹listçš„å”¯ä¸€æŒ‡å®šæ–¹æ³•setList

æ¡ˆä¾‹: ç‚¹å‡»æŒ‰é’®num+1; åœ¨å®é™…é¡µé¢æ•ˆæœä¸­ï¼Œç”±äºæ¯æ¬¡åˆ·æ–°ï¼Œnuméƒ½ä¼šå›åˆ°åˆå§‹å€¼ï¼Œæ— æ³•è¾¾åˆ°ç›®çš„ã€‚
import React,{useState,useRef} from 'react'
export default function App() {
    var num = 20;
    const [list,setList] = useState(["aa","bb","cc"])
    
```

### 3. useEffect(å¤„ç†å‰¯ä½œç”¨)å’ŒuseLayoutEffect (åŒæ­¥æ‰§è¡Œå‰¯ä½œç”¨)

Function Component ä¸å­˜åœ¨ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥ä¸è¦æŠŠ Class Component çš„ç”Ÿå‘½å‘¨æœŸæ¦‚å¿µæ¬è¿‡æ¥è¯•å›¾å¯¹å·å…¥åº§ã€‚

```
useEffect(() => {
//effect
return () => {
//cleanup
};
}, [ä¾èµ–çš„çŠ¶æ€;ç©ºæ•°ç»„,è¡¨ç¤ºä¸ä¾èµ–])
```

ä¸è¦å¯¹ Dependencies æ’’è°, å¦‚æœä½ æ˜æ˜ä½¿ç”¨äº†æŸä¸ªå˜é‡ï¼Œå´æ²¡æœ‰ç”³æ˜åœ¨ä¾èµ–ä¸­ï¼Œä½ ç­‰äºå‘ React æ’’äº†è°ï¼Œåæœ
å°±æ˜¯ï¼Œå½“ä¾èµ–çš„å˜é‡æ”¹å˜æ—¶ï¼ŒuseEffect ä¹Ÿä¸ä¼šå†æ¬¡æ‰§è¡Œ, eslintä¼šæŠ¥è­¦å‘Š

```
let id = props.match.params.myid useEffect(()=>{
axios.get(`/articles/${id}`).then(res => { settitle(res.data.title) setcontent(res.data.content) setcategory(res.data.category)
})
},[id])
```

**useEï¬€ect**å’Œ **useLayoutEï¬€ect**  æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**ç®€å•æ¥è¯´å°±æ˜¯è°ƒç”¨æ—¶æœºä¸åŒï¼Œ**
useLayoutEffect **å’ŒåŸæ¥** componentDidMount **&** componentDidUpdate **ä¸€è‡´ï¼Œåœ¨ reactå®ŒæˆDOMæ›´æ–°åé©¬ä¸Š**åŒæ­¥**è°ƒç”¨çš„ä»£ç ï¼Œä¼šé˜»å¡é¡µé¢æ¸²æŸ“ã€‚è€Œ**
useEffect **æ˜¯ä¼šåœ¨æ•´ä¸ªé¡µé¢æ¸²æŸ“å®Œæ‰ä¼šè°ƒç”¨çš„ä»£ç **



### 4. useRefï¼ˆæ˜¯hooksä¸€ç§ï¼Œä¸€èˆ¬åœ¨**å‡½æ•°ç»„ä»¶ä½¿ç”¨**ï¼‰

ä½œç”¨æ˜¯ï¼šè®°ä½çŠ¶æ€

```
export default function App() {
    const mytext = useRef() // React.createRef()
    
    const handleAdd = ()=>{
        console.log(mytext.current.value) // è·å–å€¼
    }
 
  return (<div>
            <input ref={mytext}/> 
               <button onClick={handleAdd}>add</button>
```

å®˜æ–¹å»ºè®®ä¼˜å…ˆä½¿ç”¨useEffect

åœ¨å®é™…ä½¿ç”¨æ—¶å¦‚æœæƒ³é¿å…**é¡µé¢æŠ–åŠ¨**ï¼ˆåœ¨useEffect é‡Œä¿®æ”¹DOMå¾ˆæœ‰å¯èƒ½å‡ºç°ï¼‰çš„è¯ï¼Œå¯ä»¥æŠŠéœ€è¦æ“ä½œDOMçš„ä»£ç æ”¾åœ¨useLayoutEffect é‡Œã€‚åœ¨è¿™é‡Œåšç‚¹domæ“ä½œï¼Œè¿™äº›domä¿®æ”¹ä¼šå’Œ
react åšå‡ºçš„æ›´æ”¹ä¸€èµ·è¢«ä¸€æ¬¡æ€§æ¸²æŸ“åˆ°å±å¹•ä¸Šï¼Œåªæœ‰ä¸€æ¬¡å›æµã€é‡ç»˜çš„ä»£ä»·

### **5. useCallback(**è®°å¿†å‡½æ•°**)**

é˜²æ­¢å› ä¸ºç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œå¯¼è‡´æ–¹æ³•è¢«é‡æ–°åˆ›å»º ï¼Œèµ·åˆ°ç¼“å­˜ä½œç”¨*;* åªæœ‰ç¬¬äºŒä¸ªå‚æ•° å˜åŒ–äº†ï¼Œæ‰é‡æ–°å£°æ˜ä¸€æ¬¡ã€‚

```react
var handleClick = useCallback(()=>{ console.log(name)
},[name])
<button onClick={()=>handleClick()}>hello</button>

//åªæœ‰nameæ”¹å˜åï¼Œ  è¿™ä¸ªå‡½æ•°æ‰ä¼šé‡æ–°å£°æ˜ä¸€æ¬¡ï¼Œ
//å¦‚æœä¼ å…¥ç©ºæ•°ç»„ï¼Œ  é‚£ä¹ˆå°±æ˜¯ç¬¬ä¸€æ¬¡åˆ›å»ºåå°±è¢«ç¼“å­˜ï¼Œ  å¦‚æœnameåæœŸæ”¹å˜äº†,æ‹¿åˆ°çš„è¿˜æ˜¯è€çš„nameã€‚
//å¦‚æœä¸ä¼ ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ¯æ¬¡éƒ½ä¼šé‡æ–°å£°æ˜ä¸€æ¬¡ï¼Œæ‹¿åˆ°çš„å°±æ˜¯æœ€æ–°çš„name.

```

**useMemo** **è®°å¿†ç»„ä»¶**

useCallback çš„åŠŸèƒ½å®Œå…¨å¯ä»¥ç”± useMemo æ‰€å–ä»£ï¼Œå¦‚æœä½ æƒ³é€šè¿‡ä½¿ç”¨ useMemo è¿”å›ä¸€ä¸ªè®°å¿†å‡½æ•°ä¹Ÿæ˜¯å®Œå…¨å¯ä»¥çš„

```react
useCallback(fn, inputs) is equivalent to useMemo(() => fn, inputs).
```

å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼š**useCallback** **ä¸ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªå‚æ•°å‡½æ•°ï¼Œè€Œæ˜¯å°†å®ƒè¿”å›ç»™ä½ ï¼Œè€Œ** **useMemo** **ä¼šæ‰§è¡Œç¬¬ä¸€ä¸ªå‡½æ•°å¹¶****ä¸”å°†å‡½æ•°æ‰§è¡Œç»“æœè¿”å›ç»™ä½ ã€‚**æ‰€ä»¥åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥è¿”å› handleClick æ¥è¾¾åˆ°å­˜å‚¨å‡½æ•°çš„ç›®çš„ã€‚

æ‰€ä»¥ useCallback å¸¸ç”¨è®°å¿†äº‹ä»¶å‡½æ•°ï¼Œç”Ÿæˆè®°å¿†åçš„äº‹ä»¶å‡½æ•°å¹¶ä¼ é€’ç»™å­ç»„ä»¶ä½¿ç”¨ã€‚è€Œ useMemo æ›´é€‚åˆç»è¿‡å‡½æ•°è®¡ç®—å¾—åˆ°ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œæ¯”å¦‚è®°å¿†ç»„ä»¶ã€‚(ç±»ä¼¼ä¸vueçš„è®¡ç®—å±æ€§)

### **6. useRef(**ä¿å­˜å¼•ç”¨å€¼**)**

```react
const myswiper = useRef(null);
<Swiper ref={myswiper}/>
```

ref å†™åœ¨domä¸Šæ˜¯valueå€¼ï¼Œå†™åœ¨ç»„ä»¶ä¸Šï¼Œæ˜¯ç»„ä»¶å¯¹è±¡ã€‚



### 7. useContextï¼ˆå‡å°‘ç»„ä»¶å±‚çº§ï¼‰

å¯¹classç±»ç»„ä»¶ä¸­ä½¿ç”¨contextæ–¹æ³•ï¼Œ

åœ¨å‡½æ•°å¼ç»„ä»¶ä¸­çš„ç®€åŒ–å†™æ³•ã€‚ æä¾›ç«¯æ²¡æœ‰ç®€åŒ–ï¼Œæ¥å—ç«¯è¾ƒå¤§ç®€åŒ–ã€‚

```react
import React, { useState,useEffect,useContext } from 'react'
import axios from 'axios'
import './css/index.css'

const GlobalContext  = React.createContext() //åˆ›å»ºcontextå¯¹è±¡

export default function App (){
    const [filmList, setfilmList] = useState([])
    const [info, setinfo] = useState("")

    useEffect(() => {
        axios.get(`/test.json`).then(res=>{
            // console.log(res.data.data.films)
            setfilmList(res.data.data.films)
        })
    }, []);

    return (
        <GlobalContext.Provider value={{
            call:"æ‰“ç”µè¯",
            sms:"çŸ­ä¿¡",
            info:info,
            changeInfo:(value)=>{
                setinfo(value)
            }
        }}>
            <div>
                {/* {this.state.info} */}
                {
                    filmList.map(item=>
                        <FilmItem key={item.filmId} {...item} ></FilmItem>    
                    )
                }


                <FilmDetail ></FilmDetail>
            </div>
        </GlobalContext.Provider>
    )
}

/*å—æ§ç»„ä»¶*/

function FilmItem(props){
    let {name, poster,grade,synopsis}  = props
    const value = useContext(GlobalContext)

    console.log(value)// çˆ¶ç»„ä»¶GlobalContext.Provider æä¾›çš„å€¼ï¼šcall:"æ‰“ç”µè¯",
    return <div className="filmitem" onClick={()=>{
                console.log(synopsis)

                value.changeInfo(synopsis)
            }}>
                <img src={poster} alt={name}/>
                <h4>{name}</h4>
                <div>è§‚ä¼—è¯„åˆ†ï¼š{grade}</div>
            </div> 
}



function FilmDetail(){
    const value = useContext(GlobalContext)
    return <div className="filmdetail">
        detail-{value.info}
    </div>
}
```

### 8.useReducer çš„ä½¿ç”¨

åŠŸèƒ½ï¼šHooksæä¾›çš„ä¸€ç§ï¼Œå°†ç»„ä»¶çŠ¶æ€æåˆ°å¤–é¢çš„æ–¹æ³•ã€‚

æ¡ˆä¾‹ï¼š å¯¹countæ•°å­—ï¼Œ +  -- æ“ä½œã€‚

```react
import React,{useReducer} from 'react'
 //å¤„ç†å‡½æ•°
 const reducer = (prevState,action)=>{
    //  console.log("reduercer",prevState,action)
     let newstate = {...prevState}
     switch(action.type){
         case "kerwin-minus":
            newstate.count--
            return newstate

         case "kerwin-add":
            newstate.count++
            return newstate
        
         default:
            return prevState
     }
 }
 // å¤–éƒ¨çš„å¯¹è±¡
 const intialState = {
     count:0,
    //  list:[]
 } 

 export default function App() {
     const [state, dispatch] = useReducer(reducer,intialState)
        console.log(state, dispatch)
     return (
         <div>
             <button onClick={()=>{
                 dispatch({
                     type:"kerwin-minus"
                 })
             }}>-</button>
             {state.count}
             <button onClick={()=>{
                 dispatch({
                    type:"kerwin-add"
                })
             }}>+</button>
         </div>
     )
 }
```

### 9.useReducer + useContexté…åˆä½¿ç”¨ï¼ˆå‡å°‘ç»„ä»¶å±‚çº§ï¼‰

  Hooksæä¾›ç±»ä¼¼reduxæ•°æ®ä»“åº“ç†å¿µçš„å·¥å…·æ–¹æ³•ã€‚

æ¡ˆä¾‹ï¼šappçˆ¶ç»„ä»¶ï¼Œ ä¼ å€¼ç»™ä¸‰ä¸ªå­ç»„ä»¶ï¼Œå…±äº«æ•°æ®å’Œæ–¹æ³•ã€‚child1ç»„ä»¶ï¼Œç‚¹å‡»ï¼Œchild2 child3è§†å›¾å˜åŒ–ã€‚

```react
import React,{useReducer,useContext} from 'react'

const initailState = {
    a:"11111",
    b:"11111"
}

const reducer = (prevState,action)=>{
    let newstate = {...prevState}
    switch(action.type){
        case "change-a":
            newstate.a = action.value
            return newstate
        case "change-b":
            newstate.b = action.value
            return newstate
        default:
            return prevState
    }
    // return prevState
}

const GlobalContext = React.createContext()
export default function App() {
    const [state, dispatch] = useReducer(reducer, initailState)
    
    return (
        <GlobalContext.Provider value={
            {
                state,
                dispatch
            }
        }>
            <div>
                <Child1/>
                <Child2/>
                <Child3/>
            </div>
        </GlobalContext.Provider>
    )
}

function Child1(){
    const {dispatch} = useContext(GlobalContext)
    return <div style={{background:"red"}}>
        <button onClick={()=>{
            dispatch({
                type:"change-a",
                value:"2222222"
            })
        }}>æ”¹å˜a</button>
        <button onClick={()=>{
            dispatch({
                type:"change-b",
                value:"333333"
            })
        }}>æ”¹å˜b</button>
    </div>
}

function Child2(){
    const {state} = useContext(GlobalContext)
    return <div style={{background:"yellow"}}>
        child2-{state.a}
    </div>
}

function Child3(){
    const {state} = useContext(GlobalContext)
    return <div style={{background:"gray"}}>
        child3-{state.b}
    </div>
}
```



### 10 è‡ªå®šä¹‰hooks

åŠŸèƒ½ï¼š é¡µé¢é€»è¾‘æ›´æ¸…æ™°ï¼Œæ›´å¥½é˜…è¯»ï¼Œä½“ç°å‡½æ•°å¼å˜æˆæ€æƒ³ã€‚

å®ç°ï¼š Hooksæä¾›ä¸€ç§æ–¹æ³•ã€‚ å…è®¸ä½ å°†ä¸€ä¸ªå¤§æ–¹æ³•ï¼ŒæŒ‰ä¸€å®šé€»è¾‘ï¼ŒæŠ½ç¦»å‡ºæ¥å†™æˆä¸€ä¸ªuse-å¼€å¤´çš„å°æ–¹æ³•ï¼Œä¸ç”¨æ‹…å¿ƒå¼‚æ­¥é—®é¢˜ã€‚æ¯æ¬¡ä¿®æ”¹ï¼Œä»£ç éƒ½ä¼šé‡æ–°ç»™å‡ºæ–°å€¼ã€‚

æ¡ˆä¾‹å¦‚ä¸‹ï¼›

```
import React, { useState,useEffect,useMemo } from 'react'
import axios from 'axios'

**1 è·å–listæ•°æ®æ–¹æ³•
function useCinemaList(){
    const [cinemaList, setcinemaList] = useState([])


    useEffect(() => {
        axios({
            url:"https://m.maizuo.com/gateway?cityId=110100&ticketFlag=1&k=7406159",
            method:"get",
            headers:{
                'X-Client-Info': '{"a":"3000","ch":"1002","v":"5.0.4","e":"16395416565231270166529","bc":"110100"}',
                
                'X-Host': 'mall.film-ticket.cinema.list'

            }
        }).then(res=>{
            setcinemaList(res.data.data.cinemas)
        })
    }, [])

    return {
        cinemaList
    }
}
 **2è·å–ç­›é€‰åçš„æ•°æ®æ–¹æ³•
function useFilter(cinemaList,mytext){
    const getCinemaList = useMemo(() => cinemaList.filter(item=>item.name.toUpperCase().includes(mytext.toUpperCase()) || 
    item.address.toUpperCase().includes(mytext.toUpperCase())
    ), [cinemaList,mytext])

    return {
        getCinemaList
    }
}

export default function Cinema(){
    const [mytext, setmytext] = useState("")
    
    const {cinemaList}  = useCinemaList()

    const {getCinemaList} = useFilter(cinemaList,mytext)

    return <div>
            {/* {this.state.mytext} */}
                <input value={mytext} onChange={(evt)=>{
                    setmytext(evt.target.value)
                }}/>
                {
                    getCinemaList.map(item=>
                        <dl key={item.cinemaId}>
                            <dt>{item.name}</dt>
                            <dd>{item.address}</dd>
                        </dl>    
                    )
                }
        </div>
}
```







### å°ç»“è§£ç–‘ï¼š

Q:  [reactä¸­useRefä¸createRefçš„åŒºåˆ«](https://www.cnblogs.com/-roc/p/16943895.html)

A:   useRef()                   React.createRef()

useRef ï¼ˆæ˜¯hooksä¸€ç§ï¼Œä¸€èˆ¬åœ¨**å‡½æ•°ç»„ä»¶ä½¿ç”¨**ï¼‰

1.1.è·å–å½“å‰domæ•°æ®ï¼ˆä¸æ¨èï¼Œæ¨èä½¿ç”¨å—æ§ç»„ä»¶-å³ä½¿ç”¨useStateç»‘å®šè¡¨å•å…ƒç´ ï¼‰

1.2ã€ä½œä¸ºå­˜å‚¨ä½¿ç”¨

createRefï¼ˆä¸€èˆ¬ç”¨äºclassç»„ä»¶ï¼Œè·å–å­ç»„ä»¶domï¼‰

1ã€createRefåˆ›å»ºçš„refå¯¹è±¡ï¼Œç»„ä»¶æ¯æ›´æ–°ä¸€æ¬¡ï¼Œrefå¯¹è±¡å°±ä¼šè¢«é‡æ–°åˆ›å»ºã€‚

åŒºåˆ«

1.    useRefåªä¼šåœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶åˆ›å»º

2.  createRefä¼šåœ¨ç»„ä»¶æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™é‡æ–°åˆ›å»º

   

   

## å Reactè·¯ç”±

### **1.**  ä»€ä¹ˆæ˜¯è·¯ç”±ï¼Ÿ

è·¯ç”±æ˜¯æ ¹æ®ä¸åŒçš„ url åœ°å€å±•ç¤ºä¸åŒçš„å†…å®¹æˆ–é¡µé¢ã€‚

ä¸€ä¸ªé’ˆå¯¹Reactè€Œè®¾è®¡çš„è·¯ç”±è§£å†³æ–¹æ¡ˆã€å¯ä»¥å‹å¥½çš„å¸®ä½ è§£å†³React components åˆ°URlä¹‹é—´çš„åŒæ­¥æ˜ å°„å…³ç³»

### 2.è·¯ç”±å®‰è£…

https://reacttraining.com/react-router/web/guides/quick-start

```
npm install react-router-dom@5

"react-router-dom": "^5.3.4",
```

### 3. è·¯ç”±ä½¿ç”¨

####  (1)è·¯ç”±æ–¹æ³•å¯¼å…¥

```
import React from "react"; import {
 BrowserRouter as Router, Switch,
 Route, Link
  } from "react-router-dom";
```

#### (2)å®šä¹‰è·¯ç”±ä»¥åŠé‡å®šå‘ æ¡ˆä¾‹hashæ¨¡å¼

  è·¯ç”±åŸºæœ¬ä½¿ç”¨

```react
<HashRouter>
  <Route path="/films" component={Films}/>
    <Route path="/cinemas" component={Cinemas}/>
</HashRouter>
å½“æµè§ˆå™¨http://localhost:3000/#/filmsæ—¶ï¼Œå±•ç¤ºå¯¹åº”ç»„ä»¶ã€‚æ’ä»¶çš„åŸºæœ¬åŠŸèƒ½å°±æ˜¯åŒ¹é…åŠŸèƒ½ã€‚
```

åŠ åŠŸèƒ½1ï¼š

å½“ç”¨æˆ·è¾“å…¥çš„è·¯å¾„ï¼Œæ²¡æœ‰å¯¹åº”é¡µé¢æ—¶ï¼Œè·³åˆ°homeé¡µå»ã€‚

```react
<HashRouter>
  <Switch>
         <Route path="/films" component={Films}/>
         <Route path="/cinemas" component={Cinemas}/>
      
       <Redirect from="/" to="/home" />   //from="/"  æ¨¡ç³ŠåŒ¹é…
   </Switch>
</HashRouter>
SwitchåµŒå¥—è·¯ç”±ï¼Œé…åˆé‡å®šä½æ ‡ç­¾ã€‚å®ç°ï¼š æµè§ˆå™¨è¾“å…¥åœ°å€åï¼Œè‡ªä¸Šè€Œä¸‹åŒ¹é…ï¼Œåªè¦åŒ¹é…åˆ°å°±è·³å‡ºã€‚æ²¡æœ‰åŒ¹é…åˆ°ï¼Œå°±é‡å®šä½åˆ°homeå»ã€‚

```

åŠ åŠŸèƒ½2ï¼š

å½“è¿›å…¥/ æ ¹è·¯ç”±ï¼Œå°±è¿›å…¥homeå»ï¼Œ å¦‚æœæ˜¯ /abc  ç­‰ä¹±è¾“å…¥çš„è·¯å¾„ï¼Œå°±è·³å…¥åˆ°NotFound æœªæ‰¾åˆ°é¡µé¢ã€‚

```react
<HashRouter>
    <Switch>
        <Route path="/films" component={Films}/>
        <Route path="/cinemas" component={Cinemas}/>
        <Route path="/center" component={Center}/>
        
        <Redirect from="/" to="/home" exact/>    
        <Route path="*" component={NotFound}/>
    </Switch>
</HashRouter>
Redirecté‡å®šå‘æ ‡ç­¾ï¼ŒåŠ exactç²¾å‡†å±æ€§ï¼Œåªæœ‰/ï¼Œæ‰è¿›å…¥home,å…¶ä»–æƒ…å†µï¼Œä¸‡èƒ½åŒ¹é…ï¼Œè¿›å…¥NotFoundé¡µé¢ã€‚
```



è§£æï¼š

exact ç²¾ç¡®åŒ¹é… (Redirect å³ä½¿ä½¿ç”¨äº†exact, å¤–é¢è¿˜è¦åµŒå¥—Switch æ¥ç”¨)ï¼›

Warning: Hash history cannot
PUSH the same path; a new entry will not be added to the history
stack,è¿™ä¸ªè­¦å‘Šåªæœ‰åœ¨hash æ¨¡å¼ä¼šå‡ºç°ã€‚

#### (3)åµŒå¥—è·¯ç”±

é¡µé¢æ•ˆæœï¼š

çˆ¶é¡µé¢ä¸­æ˜¾ç¤ºè½®æ’­å›¾å’Œä¸¤ä¸ªæŒ‰é’®  åˆ†åˆ«æ˜¾ç¤ºä¸åŒçš„å­é¡µé¢ã€‚

ä»£ç é…ç½®ï¼š

router.js  æ ¹è·¯ç”±

```
<HashRouter>
    <Switch>
        <Route path="/films" component={Films}/>   //ä¸è¦åŠ  exact å¦åˆ™å­é¡µé¢ä¸æ˜¾ç¤º
        <Route path="*" component={NotFound}/>
    </Switch>
</HashRouter>
```

filmsç»„ä»¶

```
import React, { Component } from 'react'
import Nowplaying from './films/Nowplaying'
import Comingsoon from './films/Comingsoon'
import {Redirect, Route, Switch} from 'react-router-dom'
export default class Films extends Component {
    render() {
        return (
            <div>
                <div style={{height:"200px",background:"yellow"}}>å¤§è½®æ’­</div>

                <div>å¯¼èˆªæ   æŒ‰é’®1  æŒ‰é’®2</div>

                {/* è·¯ç”±é…ç½® åµŒå¥—è·¯ç”± */}
                <Switch>
                    <Route path="/films/nowplaying" component={Nowplaying}/>
                    <Route path="/films/comingsoon" component={Comingsoon}/>
                    <Redirect from="/films" to="/films/nowplaying"/> 
                </Switch>

            </div>
        )
    }
}

```

#### (4)è·¯ç”±è·³è½¬æ–¹å¼

æŒ‰ç…§æ˜¯å¦ä»¥æ ‡ç­¾ä¾‹å¦‚<a href='#/films'/>,è¿˜æ˜¯jsè·³è½¬é¡µé¢ï¼Œåˆ†ç±»å¦‚ä¸‹ï¼š

##### a.   å£°æ˜å¼å¯¼èˆª

activeClassName å½“å‰æ˜¾ç¤ºé¡µé¢ï¼Œè‡ªåŠ¨åŠ classã€‚é…åˆcss å¯ä»¥é«˜äº®æ˜¾ç¤ºtabã€‚

```
<NavLink to="/films" activeClassName="active">films</NavLink>   //react æµè§ˆå™¨ä¸­ä¼šç¼–è¯‘æˆaæ ‡ç­¾
<NavLink to="/cinemas" activeClassName="active">cinemas</NavLink>
<NavLink to="/center" activeClassName="active">center</NavLink>
```

##### b   ç¼–ç¨‹å¼å¯¼èˆª

æ¡ˆä¾‹

###### router.js  æ ¹è·¯ç”±

```
<HashRouter>
    <Switch>
        <Route path="/films" component={Films}/>   
        <Route path="*" component={NotFound}/>
    </Switch>
</HashRouter>
```

###### filmsç»„ä»¶

```
import React, { Component } from 'react'
import Nowplaying from './films/Nowplaying'
import Comingsoon from './films/Comingsoon'
import {Redirect, Route, Switch} from 'react-router-dom'
export default class Films extends Component {
    render() {
        return (
            <div>
                <div style={{height:"200px",background:"yellow"}}>å¤§è½®æ’­</div>

                <div>å¯¼èˆªæ </div>

                {/* è·¯ç”±é…ç½® åµŒå¥—è·¯ç”± */}
            {/* <Nowplaying/> */}
                <Switch>
                    <Route path="/films/nowplaying" component={Nowplaying}/>
                    <Route path="/films/comingsoon" component={Comingsoon}/>
                    <Redirect from="/films" to="/films/nowplaying"/> 
                </Switch>

            </div>
        )
    }
}
```



###### Nowplayingç»„ä»¶

å½“é¡¹ç›®å¼•å…¥è·¯ç”±ç®¡ç†ï¼Œç»„ä»¶éƒ½ä¼ å…¥routerï¼Œè¿™æ—¶å€™ç»„ä»¶éƒ½æˆä¸ºrouterçš„å­©å­ï¼Œä¸ç®¡æ˜¯ä¸€çº§è·¯ç”±ï¼Œè¿˜æ˜¯é¡µé¢ä¸­åµŒå…¥çš„äºŒçº§è·¯ç”±ï¼Œç»„ä»¶éƒ½å¯ä»¥æ¥å—åˆ°ä¸€ä¸ªpropså‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å°±æ˜¯è·¯ç”±å¯¹è±¡ã€‚

```javascript
å¯¹è±¡ä¸­åŒ…å«äº†å’Œè·¯ç”±ç›¸å…³çš„å±æ€§å’Œæ–¹æ³•ã€‚
{
  history,(æœ‰è·¯ç”±ç›¸å…³æ–¹æ³•ï¼š push go goBack goForward replace locationç­‰)
  location  
  match  
}
```

propså‚æ•°  æ ¹æ®æ¥æºåˆ†ä¸ºä¸¤ç§ï¼š

ç¬¬ä¸€ç§ï¼šå½¢å‚ä¼ å…¥  æœ‰ä»¥ä¸Šä¸‰ä¸ªå¯¹è±¡

ç¬¬äºŒç§ï¼šä½¿ç”¨routerå¯¹è±¡

```
import { useHistory } from 'react-router-dom'
 const history  = useHistory()
 conosole.log(history)
 è¿™ä¸ªé‡Œé¢åªæœ‰ historyä¸€ä¸ªï¼› èŒƒå›´å°ä¸€äº›ã€‚
```

Nowplayingç»„ä»¶

```
import React,{useState} from 'react'
import { useHistory } from 'react-router-dom'

export default function Nowplaying( props ) {
    const [list, setlist] = useState(["aa","bb","cc"])
    
      const history  = useHistory()
        
    const handleChangePage = (id)=>{
        // console.log("click")
        //  1.åŸç”Ÿjsè·³è½¬
        // window.location.href="#/detail/"+id

        2.ä½¿ç”¨å…¥å‚çš„props
        // props.history.push(`/detail/${id}`)   //å‡½æ•°å¼å†™æ³•ï¼ˆï¼‰
        // this.props.history.push(`/detail/${id}`) // ç±»ç»„ä»¶å¼å†™æ³•
        
  ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨ useHistory æ–¹æ³•æ¥è‡ª routeræ’ä»¶æä¾›
        //1 -åŠ¨æ€è·¯ç”±ä¼ å‚
        // history.push(`/detail/${id}`)
    
        // 2- queryä¼ å‚
        // history.push({ pathname : '/detail' ,query : { myid: id} })

        // 3- stateä¼ å‚
        // history.push({pathname:"/detail",state:{myid:id}})
    }

    return (
        <div>
            {
                list.map(item=> <li onClick={()=>handleChangePage(item)}>{item}</li>)
            }
        </div>
    )
}
```

#### (5) è·¯ç”±ä¼ å‚

##### å£°æ˜å¼ä¼ å‚

ç‰¹å¾å’Œä¼˜ç¼ºç‚¹ï¼š

 å‚æ•°ä¿å­˜ä½ç½®ï¼Œ urlè·¯å¾„ä¸­ã€‚    å½“é¡µé¢åˆ·æ–°ï¼Œå‚æ•°ä¸ä¼šä¸¢å¤±ã€‚

router.js  æ ¹è·¯ç”±

```
<HashRouter>
    <Switch>
        {/* /detail/1111  åŠ¨æ€è·¯ç”± */}
         <Route path="/detail/:myid" component={Detail} /> 
        <Route path="*" component={NotFound}/>
    </Switch>
</HashRouter>
```

###### Nowplayingç»„ä»¶   

åˆ—è¡¨ç»„ä»¶  å…¥å‚

```
å¦‚ä¸Šä»£ç å¿«
...
 2.ä½¿ç”¨å…¥å‚çš„props
 // props.history.push(`/detail/${id}`)   //å‡½æ•°å¼å†™æ³•ï¼ˆï¼‰
...
```

detail è¯¦æƒ…ç»„ä»¶ æ¥å‚

å½“å‰è·¯å¾„   http://localhost:3000/#/detail/bb

```
import React from 'react'

export default function Detail(props) {
    console.log(props.match.params.myid,"åˆ©ç”¨idå»åç«¯æ‹¿æ•°æ®ã€‚")  //bbä¸ºå‚æ•°å€¼  myidä¸ºå½¢å‚
    return (
        <div>
            deteail
        </div>
    )
}
```

##### ç¼–ç¨‹å¼ä¼ å‚    

ç‰¹å¾å’Œä¼˜ç¼ºç‚¹ï¼š

 å‚æ•°ä¿å­˜ä½ç½®ï¼Œ ç¼“å­˜ä¸­ã€‚    å½“é¡µé¢åˆ·æ–°ï¼Œå‚æ•°ä¼šä¸¢å¤±ã€‚

router.js  

æ ¹è·¯ç”±path="/detail" è¿™ç§ä¼ å‚å°±ä¸è¦åŠ å½¢å‚  ï¼šmyidäº†ã€‚

```
<HashRouter>
    <Switch>
         <Route path="/detail" component={Detail} /> 
        <Route path="*" component={NotFound}/>
    </Switch>
</HashRouter>
```

###### 

```
(1)
   å…¥å‚
this.props.history.push({ pathname : '/user' ,query : { day: 'Friday'} }) 
   æ¥å—å‚æ•°
this.props.location.query.day
(2)
    å…¥å‚
this.props.history.push({ pathname:'/user',state:{day : 'Friday' } }) 
  æ¥å—å‚æ•°
this.props.location.state.day
ä»£ç å‚è€ƒï¼ˆ4ï¼‰è·¯ç”±è·³è½¬æ–¹å¼å°ç»“ã€‚
  æµ‹è¯•å‘ç°this.props.history.pushä¼ å…¥çš„å¯¹è±¡ï¼Œ pathnameæ˜¯å¿…é¡»æŒ‰ç…§æ ¼å¼ï¼Œåé¢query stateæˆ–æ˜¯å…¶ä»–å±æ€§ï¼Œéƒ½å¯ä»¥ï¼Œåªè¦åœ¨æ¥å—å‚æ•°å¤„ï¼Œä¸€ä¸€å¯¹åº”å³å¯ã€‚
```

### 4. è·¯ç”±æ‹¦æˆªï¼ˆè·¯ç”±å®ˆå«ï¼‰

react å¹¶æ²¡æœ‰åƒvue router.beforeEachè·¯ç”±å‰ï¼Œè·¯ç”±åç­‰api; æ‰€ä»¥è¿™é‡Œåªæ˜¯ç”¨åŸç”Ÿå‡½æ•°æ–¹æ³•ã€‚

router.js

```
é‰´æƒä»£ç  
function isAuth(){
    return localStorage.getItem("token")
}



<Router>
      <Switch>
          <Route path="/films" component={Films}  />
      <Route path="/center" render={(props)=>{
        return isAuth()?<Center myname="tom"/>:<Redirect to="/login"/>
      }/>                 
```

### 5 è·¯ç”±æ¨¡å¼

##### hashæ¨¡å¼

åƒè¿™ç§å¸¦#å·çš„ï¼Œå«é”šç‚¹ï¼Œè¿™é‡Œç§°hashæ¨¡å¼ã€‚ä¸å‘èµ·è¯·æ±‚ã€‚

å¦‚æœä¸æƒ³çœ‹åˆ°è¿™æ ·ï¼Œå¯ä»¥ä½¿ç”¨ä»¤ä¸€ç§æ¨¡å¼ã€‚

```
http://localhost:3000/#/login

import React, { Component } from 'react'
import { HashRouter as Router,Redirect,Route,Switch} from 'react-router-dom'

export default class IndexRouter extends Component {
    render() {
        return (
            <Router>   æ¨¡å¼æ ‡ç­¾
                <Switch>
                    <Route path="/films" component={Films}  />
```

##### historyæ¨¡å¼

http://localhost:3000/login     åƒä¸€ä¸ªçœŸæ­£çš„è·¯å¾„ã€‚

BrowserRouter æ²¡æœ‰#çš„è·¯å¾„ï¼Œå¥½çœ‹ ï¼ŒçœŸæ­£æœåç«¯å‘è¯·æ±‚è¦é¡µé¢ï¼Œåç«¯æ²¡æœ‰å¯¹åº”çš„è·¯å¾„å¤„ç†è·¯å¾„ï¼Œ å°±ä¼š404ï¼Œ ä¸å¥½çœ‹ã€‚æ‰€ä»¥åå°è¦åšå¤„ç†ï¼Œå› ä¸ºé¡¹ç›®æ˜¯å•é¡µé¢ï¼Œåå°å¹¶æ²¡æœ‰å¯¹åº”èµ„æºï¼Œåªéœ€è¦è¿”å›index.htmlï¼Œå‰å°é‡æ–°æ¸²æŸ“ã€‚

```
import React, { Component } from 'react'
import { BrowserRouter as Router,Redirect,Route,Switch} from 'react-router-dom'
...
 <Router>   æ¨¡å¼æ ‡ç­¾
 æˆ–è€…
 import { BrowserRouter,Redirect,Route,Switch} from 'react-router-dom'
...
 <BrowserRouter>  </BrowserRouter>  æ¨¡å¼æ ‡ç­¾

```

BrowserRouter as Router æ„ä¸ºï¼š BrowserRouter è§£æ„å‡ºæ¥ï¼Œèµ·äº†ä¸€ä¸ªåˆ«åå«Routerã€‚ è¿™æ ·åé¢ä»£ç å°±ä¸ç”¨æ”¹äº†ã€‚æ›´åŠ ä¾¿æ·ã€‚

### 6 ç»„ä»¶ä¸¢çˆ¹historyå’Œå¹²çˆ¹æ”¯æ´ï¼ˆé«˜é˜¶ç»„ä»¶withRouterï¼‰

#### ç¬¬ä¸€ç§æƒ…å†µï¼šrouter ä¼ é€’é¡µé¢ç»„ä»¶ 

##### 

é¦–å…ˆç¡®å®šï¼Œçˆ¶ç»„ä»¶ä¼ å‚ï¼Œå­ç»„ä»¶propsæ¥å—å‚æ•°ã€‚

router.js

```
 <BrowserRouter>
                <Switch>
                    <Route path="/films" component={Films}  />
                    
                     <Route path="/center" render={()=>{
                        return isAuth()?<Center myname="tom"/>:<Redirect to="/login"/>
                    }}/>          
```

å‰é¢è·¯ç”±å®ˆå«æ—¶ï¼Œcenterç»„ä»¶åšäº†å¤„ç†ï¼Œå½“æˆ‘ä»¬åœ¨centerç»„ä»¶ä¸­ï¼Œä½¿ç”¨historyæ–¹æ³•æ—¶ï¼Œé¡µé¢æç¤ºæœªæ‰¾åˆ°æ–¹æ³•ã€‚

centerç»„ä»¶ 

```
export default function Center(props) {
    return (
        <div>
            center

            <div onClick={()=>{
                props.history.push(`/filmsorder`)

                // console.log(props)
            }}>ç”µå½±è®¢å•</div>
        </div>
    )
}
```

å‰é¢æˆ‘ä»¬æåˆ°ï¼Œä½¿ç”¨è·¯ç”±æ—¶ï¼Œè¢«è·¯ç”±æ ‡ç­¾   <Router>   </Router> åŒ…è£¹çš„é¡µé¢ç»„ä»¶ï¼Œéƒ½æ˜¯å­ç»„ä»¶ï¼Œè‡ªç„¶å¯ä»¥æ¥å—propså‚æ•°ï¼ŒåŒ…å«historyç­‰ã€‚

æŸ¥çœ‹routeæ ¸å¿ƒæ–¹æ³•

```
// class Route extends Component{
//     ...

//     render(){
//         var MyComponent = this.props.component
//     return <div>
//             <MyComponent history={} match={}.../>
//         </div>
//     }
// }
```

routeä»¥å˜é‡å½¢å¼ï¼Œæ¥å—ç»„ä»¶ï¼Œä¼ å…¥å‚æ•°ï¼Œå†renderå‡ºå»ã€‚è€Œcenterè¿™æ¡è·¯ç”±ï¼Œç›´æ¥ä½¿ç”¨renderï¼Œå¹¶æ²¡æœ‰ä¼ å‚ï¼Œæµ‹è¯•ä¼ é€’ä¸€ä¸ªè‡ªå®šä¹‰å‚æ•°myname, centerç»„ä»¶ä¸­ï¼Œæ‰“å°propsï¼Œæœç„¶çœ‹åˆ°å‚æ•°tom,è¯å®ç¡®å®æ˜¯routeç»™å‡ºçš„ä¸œè¥¿ï¼Œæ²¡æœ‰ä¼ é€’ä¸‹å»ï¼Œå¯¼è‡´å­ç»„ä»¶historyæ–¹æ³•ç¼ºå¤±ã€‚

```
<Route path="/center" render={()=>{
                        return isAuth()?<Center myname="tom"/>:<Redirect to="/login"/>
                    }}/> 
```

æ”¹è¿›, è§£æ„ï¼Œä¼ å‚ä¸‹å»

```
    <Route path="/center" render={(props)=>{
                        console.log(props,'æ‰§è¡Œäº†')
                        return isAuth()?<Center myname="kerwin" {...props}/>:<Redirect to="/login"/>
                    }}/>
```

#### ç¬¬äºŒç§æƒ…å†µ ç»„ä»¶ä¼ é€’ç»„ä»¶

ä»£ç ä¸­ï¼ŒFilmItemå°ç»„ä»¶ï¼Œ props.history.pushæç¤ºæœªæ‰¾åˆ°ï¼Œæƒ…å†µå’Œç¬¬ä¸€ç§ç›¸ä¼¼ï¼Œéƒ½æ˜¯å‚æ•°åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œä¸­æ–­ã€‚

```
import React,{useState} from 'react'
export default function Nowplaying(props) {       <----------1è¿™ä¸ªpropså‚æ•°
    const [list, setlist] = useState([1,2,3,4])

    return (
        <div>
            {
                list.map(item=>
                 <FilmItem key={item.filmId} {...item} 	/>     <----------2è¿™é‡Œ {...props}
                )
            }
        </div>
    )
}

function FilmItem(props){
    // console.log(props)  // æ‰“å°æ²¡æœ‰ props.history
    let {name,filmId} = props
    return <li onClick={()=>{
        props.history.push(`/detail/${filmId}`)
    }}>
        {name}
    </li>    
}
```

#### å¹²çˆ¹æ”¯æ´

çˆ¶ç»„ä»¶  ---> å­ç»„ä»¶ ---> å­™ç»„ä»¶ï¼Œ æœ‰ç‚¹éº»çƒ¦ï¼Œæ˜¯å¦æœ‰å…¶ä»–ä¾¿æ·apiï¼Ÿ

routeræä¾›ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œä½œç”¨æ˜¯ä¸ºæ²¡æœ‰è·¯ç”±å±æ€§å’Œæ–¹æ³•çš„æ™®é€šç»„ä»¶ï¼Œå¢ç›Šæ–¹æ³•ã€‚

```
import {withRouter} from 'react-router-dom'
```

ä½¿ç”¨æ–¹æ³•ï¼š

```
import React,{useState} from 'react'
import {useHistory,withRouter} from 'react-router-dom'

export default function Nowplaying(props) {
    const [list, setlist] = useState([1,2,3,4])

    return (
        <div>
            {
                list.map(item=>
                 <WithFilmItem key={item.filmId} {...item} />
                )
            }
        </div>
    )
}

             è¿™æ˜¯ä¸€ä¸ªæ™®é€šå­™ç»„ä»¶           
function FilmItem(props){
    // console.log(props)
    let {name,filmId} = props
    return <li onClick={()=>{
        props.history.push(`/detail/${filmId}`)
    }}>
        {name}
    </li>    
}


const WithFilmItem = withRouter(FilmItem)  <----- withRouteræ–¹æ³•ï¼ŒåŒ…è£¹æ™®é€šç»„ä»¶ï¼Œåå‡ºæ¥å¢ç›Šç»„ä»¶ã€‚è¿™æ ·ï¼ŒFilmItemä¸­çš„onClické‡Œé¢ï¼Œå°±å¯ä»¥ä½¿ç”¨ props.history.pushäº†ã€‚
```

#### withRouter   çš„åº”ç”¨ä¸åŸç†

You can get access to the history object's properties and the closest <Route>'smatch via the withRouter higher-order component.wi thRouter will pass updatedmatch, location, and history props to the wrapped component whenever itrenders.

```
åªè¦è¢«withRouteråŠ å·¥åï¼Œå°±å¯ä»¥è·å–åˆ°historyç›¸å…³ã€‚
 import { withRouter } from "react-router"; 
 withRouter(MyComponent); 
 withRouter(connect(...)(MyComponent))

```





## åä¸€  Fluxä¸Redux

## åäºŒ react-redux

## åä¸‰ UIç»„ä»¶åº“

## åå›› Immutable

## åäº” Mobx

## åå…­ TS

## åä¸ƒ styled-components

## åå…« å•å…ƒæµ‹è¯•

## åä¹ redux-saga

## äºŒå Reactè¡¥å……

## äºŒåä¸€ Reactæ‰©å±•

## äºŒåäºŒ å‰ç«¯ä»£ç†ï¼ˆåå‘ä»£ç†ï¼‰

å®˜ç½‘ï¼š

 https://facebook.github.io/create-react-app/docs/proxying-api-requests-in-development

 å¼•å…¥æ’ä»¶

```
npm install http-proxy-middleware --save
```

srcä¸‹åˆ›å»º src/setupProxy.jsæ–‡ä»¶ï¼Œå‚æ•°å¦‚ä¸‹

```

const { createProxyMiddleware } = require('http-proxy-middleware');

module.exports = function(app) { app.use(
  '/api', createProxyMiddleware({
    target: 'http://localhost:5000', 
    changeOrigin: true,
   })
   );
};
è¡¨ç¤ºï¼šä»£ç†æ‹¦æˆª/apiå¼€å¤´çš„è¯·æ±‚ï¼Œå¹¶åœ¨å…¶urlå‰é¢åŠ ä¸Šhttp://localhost:5000åŸŸåã€‚
```



æ¡ˆä¾‹ï¼šæŸçœ¼ç”µå½±æ¥å£

```
https://i.maoyan.com/#movie/.f-hot
```

è¯·æ±‚å¾…æ˜ åˆ—è¡¨æ•°æ®ï¼Œç›´æ¥ä½¿ç”¨æç¤ºè·¨åŸŸã€‚

```
https://i.maoyan.com/ajax/mostExpected?limit=10&offset=0&token=&optimus_uuid=B13246E07BC511EE8C86B72966AD43929DD65EA435C340D6A572D95977F59FCA&optimus_risk_level=71&optimus_code=10
```

é¡¹ç›®é…ç½®å¦‚ä¸‹ï¼š

setupProxy.jsæ–‡ä»¶

```
const { createProxyMiddleware } = require('http-proxy-middleware');

module.exports = function(app) {
  app.use(
    '/ajax',
    createProxyMiddleware({
      target: 'https://i.maoyan.com',
      changeOrigin: true,
    })
  );
};
```

ç»„ä»¶å¦‚ä¸‹:   

```
import React, {  Component } from 'react'
import axios from 'axios'
export default class Comingsoon extends Component {

  componentWillMount(){
    axios({
        url:"/ajax/mostExpected?limit=10&offset=0&token=&optimus_uuid=B13246E07BC511EE8C86B72966AD43929DD65EA435C340D6A572D95977F59FCA&optimus_risk_level=71&optimus_code=10", 
    }).then(res=>{
        // console.log(res.data.data.films) æˆåŠŸè¿”å›æ•°æ®
    
    })
  }
    render() {
        return (
            <div>
                Comingsoon
            </div>
        )
    }
}

```

## äºŒåä¸‰  css module

å®˜ç½‘

https://facebook.github.io/create-react-app/docs/adding-a-css-modules-stylesheet

å¼•å…¥èƒŒæ™¯ï¼š

reactæ˜¯å•é¡µé¢ï¼Œ æ¯ä¸ªç»„ä»¶å¼•å…¥çš„cssæ ·å¼ï¼Œç¼–è¯‘æ—¶ï¼Œä¼šè‡ªåŠ¨æ’å…¥åˆ°index.htmlé¡µé¢ä¸­ï¼Œé€ æˆæ ·å¼æ±¡æŸ“ã€‚

film.css

```
.father{
  border: 1px solid red;
}
```

filmç»„ä»¶

```
import '../css/film.css' //å¯¼å…¥ cssæ¨¡å—ï¼Œ  webpackçš„æ”¯æŒã€‚

        return (
                <div className='father'>å¯¼èˆªæ </div>
```

å­ç»„ä»¶

```
  render() {
        return (
            <div className='father'>
                Comingsoon
            </div>
```

çˆ¶ç»„ä»¶å¼•å…¥çš„æ ·å¼ï¼Œ æ±¡æŸ“åˆ°äº†å­ç»„ä»¶ã€‚

è§£å†³æ–¹å¼ï¼š

file.css æ–‡ä»¶åå­—ï¼Œæ”¹é€ ä¸ºfilm.module.css   è§„å®šå†™æ³•

```
.father{
  border: 1px solid red;
  .child{
    color: yellow;
  }
}
#id{
  color: red;
}


ç§æœ‰æ ·å¼æ–‡ä»¶ä¸­  å†™å…¨å±€css   ï¼›å»ºè®®å¦‚æœæ˜¯é¡¹ç›®å…¨å±€css, å•ç‹¬æ–°å»ºä¸€ä¸ª common.css æ¯”è¾ƒå¥½ã€‚
:global(.active){

}

```

film.jsç»„ä»¶

```
import style from  '../css/film.module.css' //å¯¼å…¥ cssæ¨¡å—ï¼Œ  webpackçš„æ”¯æŒã€‚

    render() {
        return (
            <div>
                <div className={style.father +" othercss"}>å¯¼èˆªæ </div>  
                //å˜é‡å†™æ³• å› ä¸ºç±»ååŠ åç¼€åŠ¨æ€åŒ– ç§æœ‰åŒ–


css æ‰“å°å‡ºæ¥å˜é‡åå­— å’Œjsç›¸ä¼¼
console.log(style)
{
father: 'film_father__HgGKs', 
child: 'film_child__2Bvwp', 
id: 'film_id__2TOI9'
}

```











## å…¶ä»–



### hooksä¸­è®°ä½çŠ¶æ€çš„æ–¹å¼

useRef

### å…³äºç”Ÿå‘½å‘¨æœŸ

*1.ç±»ç»„ä»¶ Class Component* æœ‰ç”Ÿå‘½å‘¨æœŸæ¦‚å¿µã€‚

2.å‡½æ•°ç»„ä»¶*Function Component* ä¸å­˜åœ¨ç”Ÿå‘½å‘¨æœŸï¼Œ

é»˜è®¤ä¸èƒ½ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸ å¦‚æœè¦ä½¿ç”¨ é‚£ä¹ˆå°±è¦ä½¿ç”¨HOOKæ¥å®Œæˆã€‚

react16.8ç‰ˆæœ¬ä¹‹åæ–°å¢çš„ä¸€ä¸ªæ¦‚å¿µ

HOOK---useEffect

**useEffectå°±å¯ä»¥è®©å‡½æ•°ç»„ä»¶ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸ---ä»–ä¼šåœ¨ æŒ‚è½½å®Œæ¯• ä¿®æ”¹å®Œæ¯• å‡†å¤‡é”€æ¯ è¿™ä¸‰ä¸ªé˜¶æ®µéƒ½è§¦å‘**

è¯­æ³•ï¼š

```
useEffect(ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°,ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„)
```